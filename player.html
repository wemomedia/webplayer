<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Wevr Player</title>
      <style>
          body {
              margin: 0px;
              background-color: #000000;
              overflow: hidden;
          }

          #container {
          	width:100%;
          	height:95%;
          	position:absolute;
          	border:none;
          	overflow:hidden;
          	background-color: green;
          }

          #video-controls {
          	top:95%;
          	height:5%;
          	position:absolute;
          	border:none;
          	color:white;
          	font-family:sans-serif;
          	font-size: 12px;
          	overflow:hidden;
          }

      </style>
</head>
<body>
	<div id="container"></div>
	  <!-- Video Controls -->
	  <div id="video-controls">
	    <button type="button" id="play-pause">Play</button>
	    <input type="range" id="seek-bar" value="0">
	    <button type="button" id="mute">Mute</button>
	    <label>Volume</label>
	    <input type="range" id="volume-bar" min="0" max="1" step="0.1" value="1">
	    <button type="button" id="full-screen">FullScreen</button>
	  </div>

	<!--
	<option value="encounterTest_01082015.mp4">theBlu: Encounter</option>
		video.src = '/360videos/' + url;
	-->

	<script src="./libs/three.js.r73/three.js"></script>
	<script src="./libs/three.js.r73/OrbitControls.js"></script>
	<script src="./libs/requestAnimationFrame/RequestAnimationFrame.js"></script>
	<script src="./js/wevr.js"></script>
	<script src="./js/player.js"></script>
	<script>
	
	var DEFAULT_URL = '/360videos/encounterTest_01082015.mp4';

	window.onload = function() {
		var container = document.getElementById("container");

	    var str = window.location.search;
	    var params = {};

	    str.replace(
	        new RegExp( "([^?=&]+)(=([^&]*))?", "g" ),
	        function( $0, $1, $2, $3 ){
	            params[ $1 ] = $3;
	        }
	    );


		var src = params.url ? params.url : DEFAULT_URL;

		var player = new WEVR.Player({ 
				container : container,
				src : src,
			});

		var video = player.video;

		// Buttons
		var playButton = document.getElementById("play-pause");
		var muteButton = document.getElementById("mute");
		var fullScreenButton = document.getElementById("full-screen");

		// Sliders
		var seekBar = document.getElementById("seek-bar");
		var volumeBar = document.getElementById("volume-bar");

		// Event listener for the play/pause button
		playButton.addEventListener("click", function() {
		  if (video.paused == true) {
		    // Play the video
		    video.play();

		    // Update the button text to 'Pause'
		    playButton.innerHTML = "Pause";
		  } else {
		    // Pause the video
		    video.pause();

		    // Update the button text to 'Play'
		    playButton.innerHTML = "Play";
		  }
		});

		// Event listener for the mute button
		muteButton.addEventListener("click", function() {
		  if (video.muted == false) {
		    // Mute the video
		    video.muted = true;

		    // Update the button text
		    muteButton.innerHTML = "Unmute";
		  } else {
		    // Unmute the video
		    video.muted = false;

		    // Update the button text
		    muteButton.innerHTML = "Mute";
		  }
		});

		// Event listener for the seek bar
		seekBar.addEventListener("change", function() {
		  // Calculate the new time
		  var time = video.duration * (seekBar.value / 100);

		  // Update the video time
		  video.currentTime = time;
		});		

		// Update the seek bar as the video plays
		video.addEventListener("timeupdate", function() {
		  // Calculate the slider value
		  var value = (100 / video.duration) * video.currentTime;

		  // Update the slider value
		  seekBar.value = value;
		});

		// Event listener for the full-screen button
		fullScreenButton.addEventListener("click", function() {
			player.fullScreen();
		});


	}

	</script>
	
</body>
</html>